<section ngClass="logo-area">
    <a href="https://www.isbasgr.es/es/" target="_blank"><img src="/assets/images/logo-isba-sgr-317.png" alt="Logo de ISBA" width="30%"></a>
    <a href="https://www.adrbalears.es/es/" target="_blank" ngClass="adrLogo"><img src="/assets/ADRBalears-conselleria.jpg" alt="Logo de ADR Balears" width="60%"></a>
</section>
<section ngClass="info-header">
    <section>
        <h2>{{'ISBA.TITLE' | translate}}</h2>
        <p ngClass="banner"><strong>{{'ISBA.INFO.BANNER' | translate}}</strong></p>
    </section>
    <section ngClass="info">
        <dd>
            <dl [innerHTML]="'ISBA.INFO.DESTINATION' | translate"></dl>
            <dl [innerHTML]="'ISBA.INFO.EMITTER' | translate"></dl>
            <dl [innerHTML]="'ISBA.INFO.SIA-CODE' | translate"></dl>
            <dl [innerHTML]="'ISBA.INFO.PROCEDURE' | translate"></dl>
        </dd>
    </section>
</section>
<section>
    <form [formGroup]="isbaForm" ngClass="form" (ngSubmit)="onSubmit()">
        <div ngClass="example-action-buttons">
            <button matButton type="button" ngClass="btn-green btn" (click)="accordion().openAll()">{{'COMMON.EXPANDALL' | translate}}</button>
            <button matButton type="button" ngClass="btn-green btn" (click)="accordion().closeAll()">{{'COMMON.COLAPSEALL' | translate}}</button>
        </div>
        <mat-accordion ngClass="example-headers-align" multi>
            <!-- RGPD -->
            <mat-expansion-panel [expanded]="step() === 0" (opened)="setStep(0)">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'ISBA.RGPD.TITLE' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'ISBA.RGPD.DESCRIPTION' | translate}} <mat-icon>policy</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section>
                    <mat-checkbox formControlName="acceptRGPD">
                        <label>
                            {{'COMMON.RGPD-INFO.READ-AND-ACCEPTS.PART-1' | translate}}<abbr title="{{'COMMON.ACRONYMS.RGPD.FULL-PHRASE' | translate}}">{{'COMMON.ACRONYMS.RGPD.ACRONYM' | translate}}.</abbr><mat-icon data-icon="rgpd-icon" (click)="openDialog('300ms', '300ms', 'Sobre el RGPD', '../../../assets/data/clausulaProteccionDatos.html', '', '')">info</mat-icon>{{'COMMON.RGPD-INFO.READ-AND-ACCEPTS.PART-2' | translate}}<abbr title="{{'COMMON.ACRONYMS.ADR.FULL-PHRASE' | translate}}">{{'COMMON.ACRONYMS.ADR.ACRONYM' | translate}}</abbr>{{'COMMON.RGPD-INFO.READ-AND-ACCEPTS.PART-3' | translate}}<mat-icon data-icon="rgpd-info" (click)="openDialog('300ms', '300ms', 'Nuestra política de privacidad', '../../../assets/data/politica_privacidad.html', '', '')">info</mat-icon>
                        </label>
                    </mat-checkbox>
                    <section>
                        <p>{{'ISBA.RGPD.REQUIRED-DOCS.INFO' | translate}}</p>
                        <ol>
                            <li>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-1' | translate}}</li>
                            <li>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-2' | translate}}</li>
                            <li>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-3' | translate}}</li>
                            <li>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-4.PART-1' | translate}}<abbr title="{{'COMMON.ACRONYMS.BAT.FULL-PHRASE' | translate}}">{{'COMMON.ACRONYMS.BAT.ACRONYM' | translate}}</abbr>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-4.PART-2' | translate}}</li>
                            <li>
                                {{'ISBA.RGPD.REQUIRED-DOCS.DOC-5.INFO' | translate}}
                                <ol>
                                    <li type="a">{{'ISBA.RGPD.REQUIRED-DOCS.DOC-5.DOC' | translate}}</li>
                                </ol>
                            </li>
                            <li>
                                {{'ISBA.RGPD.REQUIRED-DOCS.DOC-6.INFO' | translate}}
                                <ol>
                                    <li type="a">{{'ISBA.RGPD.REQUIRED-DOCS.DOC-6.DOC-1' | translate}}</li>
                                    <li type="a">{{'ISBA.RGPD.REQUIRED-DOCS.DOC-6.DOC-2' | translate}}</li>
                                </ol>
                            </li>
                            <li>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-7' | translate}}</li>
                            <li>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-8.PART-1' | translate}}<abbr title="{{'COMMON.ACRONYMS.ATIB.FULL-PHRASE' | translate}}">{{'COMMON.ACRONYMS.ATIB.ACRONYM' | translate}}</abbr>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-8.PART-2' | translate}}<abbr title="{{'COMMON.ACRONYMS.ADR.FULL-PHRASE' | translate}}">{{'COMMON.ACRONYMS.ADR.ACRONYM' | translate}}</abbr>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-8.PART-3' | translate}}<abbr title="{{'COMMON.ACRONYMS.ATIB.FULL-PHRASE' | translate}}">{{'COMMON.ACRONYMS.ATIB.ACRONYM' | translate}}</abbr>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-8.PART-4' | translate}}<abbr title="{{'COMMON.ACRONYMS.TGSS.FULL-PHRASE' | translate}}">{{'COMMON.ACRONYMS.TGSS.ACRONYM' | translate}}</abbr>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-8.PART-5' | translate}}</li>
                            <li>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-9' | translate}}</li>
                            <li>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-10' | translate}}</li>
                            <li>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-11' | translate}}</li>
                            <li>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-12' | translate}}</li>
                            <li>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-13' | translate}}</li>
                            <li>{{'ISBA.RGPD.REQUIRED-DOCS.DOC-14' | translate}}</li>
                        </ol>

                        <dl>
                            <dt>{{'ISBA.RGPD.NOTIFICATION.INFO' | translate}}</dt>
                            <dd>{{'ISBA.RGPD.NOTIFICATION.DOC-1' | translate}}</dd>
                            <dd>{{'ISBA.RGPD.NOTIFICATION.DOC-2' | translate}}</dd>
                        </dl>
                    </section>
                </section>
            </mat-expansion-panel>

            <!-- Tipo Solicitante-->
            <mat-expansion-panel [disabled]="!rgpdAccepted" [expanded]="rgpdAccepted">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'COMMON.BUSINESS-TYPE.TITLE' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'COMMON.BUSINESS-TYPE.DESCRIPTION' | translate}} <mat-icon>corporate_fare</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section ngClass="form applicant-type">
                    <section>
                        <mat-radio-group formControlName="tipo_solicitante" (ngModelChange)="onBusinessTypeChange()">
                            <mat-radio-button value="autonomo">{{'COMMON.BUSINESS-TYPE.SELF-EMPLOYED' | translate}}</mat-radio-button>
                            <mat-radio-button value="pequenya">{{'COMMON.BUSINESS-TYPE.SMALL.NAME' | translate}}</mat-radio-button>
                            <mat-radio-button value="mediana">{{'COMMON.BUSINESS-TYPE.MEDIUM.NAME' | translate}}</mat-radio-button>
                        </mat-radio-group>
                    </section>
                    <section>
                        <p><strong>{{'COMMON.BUSINESS-TYPE.SMALL.NAME' | translate}}</strong>: {{'COMMON.BUSINESS-TYPE.SMALL.INFO' | translate}}</p>
                        <p><strong>{{'COMMON.BUSINESS-TYPE.MEDIUM.NAME' | translate}}</strong>: {{'COMMON.BUSINESS-TYPE.MEDIUM.INFO' | translate}}</p>
                    </section>
                </section>
            </mat-expansion-panel>

            <!-- Datos generales -->
            <mat-expansion-panel [disabled]="!rgpdAccepted" [expanded]="rgpdAccepted">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'ISBA.GENERAL-DATA.TITLE' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'ISBA.GENERAL-DATA.DESCRIPTION' | translate}} <mat-icon>person</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section ngClass="form personal-data">
                    <mat-form-field>
                        <mat-label *ngIf="businessType === 'autonomo'">{{'ISBA.GENERAL-DATA.APPLICANT.NIF.LABEL' | translate}}</mat-label>
                        <mat-label *ngIf="businessType !== 'autonomo'">{{'ISBA.GENERAL-DATA.APPLICANT.CIF.LABEL' | translate}}</mat-label>
                            <input matInput type="text" formControlName="nif" maxlength="9">
                            <mat-error *ngIf="isbaForm.get('nif')?.errors && businessType==='autonomo'">{{'ISBA.GENERAL-DATA.APPLICANT.NIF.ERROR' | translate}}</mat-error>
                            <mat-error *ngIf="isbaForm.get('nif')?.errors && businessType!=='autonomo'">{{'ISBA.GENERAL-DATA.APPLICANT.CIF.ERROR' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'ISBA.GENERAL-DATA.COMPANY-NAME.LABEL' | translate}}</mat-label>
                        <input matInput type="text" formControlName="denom_interesado">
                        <mat-error *ngIf="isbaForm.get('denom_interesado')?.errors" >{{'ISBA.GENERAL-DATA.COMPANY-NAME.ERROR' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'ISBA.GENERAL-DATA.ADDRESS.LABEL' | translate}}</mat-label>
                        <input matInput type="text" formControlName="domicilio">
                        <mat-error *ngIf="isbaForm.get('domicilio')?.errors">{{'ISBA.GENERAL-DATA.ADDRESS.ERROR' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'ISBA.GENERAL-DATA.ZIPCODE.LABEL' | translate}}</mat-label>
                        <input matInput (ngModelChange)="selectedValue()" type="text" formControlName="cpostal" maxlength="5" minlength="5" [matAutocomplete]="auto" (blur)="cleanBlank($event)">
                        <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
                            <mat-option *ngFor="let option of filteredOptions | async" [value]="option">{{option.zipCode}} {{option.town}}</mat-option> 
                        </mat-autocomplete>
                        <mat-error *ngIf="isbaForm.get('cpostal')?.errors">{{'ISBA.GENERAL-DATA.ZIPCODE.ERROR' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'ISBA.GENERAL-DATA.TOWN' | translate}}</mat-label>
                        <input matInput formControlName="localidad" readonly>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'ISBA.GENERAL-DATA.CONTACT-PHONE.LABEL' | translate}}</mat-label>
                        <input matInput type="tel" formControlName="telefono_cont" (blur)="cleanBlank($event)" minlength="9" maxlength="9">
                        <mat-error *ngIf="isbaForm.get('telefono_cont')?.errors">{{'ISBA.GENERAL-DATA.CONTACT-PHONE.ERROR' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'ISBA.GENERAL-DATA.CNAE-CODE.LABEL' | translate}}</mat-label>
                        <mat-select formControlName="codigoIAE">
                            <mat-option *ngFor="let actividad of actividadesCNAE" [value]="actividad.id">{{actividad.label_cas}}</mat-option>
                        </mat-select>
                        <mat-error *ngIf="isbaForm.get('codigoIAE')?.errors">{{'ISBA.GENERAL-DATA.CNAE-CODE.ERROR' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'ISBA.GENERAL-DATA.REPRESENTATIVE.NAME.LABEL' | translate}}</mat-label>
                        <input matInput type="text" formControlName="nom_representante">
                        <mat-error *ngIf="isbaForm.get('nom_representante')?.errors">{{'ISBA.GENERAL-DATA.REPRESENTATIVE.NAME.ERROR' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'ISBA.GENERAL-DATA.REPRESENTATIVE.NIF.LABEL' | translate}}</mat-label>
                        <input matInput type="text" formControlName="nif_representante" (blur)="cleanBlank($event)" maxlength="9" minlength="9">
                        <mat-error *ngIf="isbaForm.get('nif_representante')?.errors">{{'ISBA.GENERAL-DATA.REPRESENTATIVE.NIF.ERROR' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'ISBA.GENERAL-DATA.REPRESENTATIVE.PHONE.LABEL' | translate}}</mat-label>
                        <input matInput type="tel" formControlName="telefono_contacto_rep" (blur)="cleanBlank($event)" maxlength="9" minlength="9">
                        <mat-error *ngIf="isbaForm.get('telefono_contacto_rep')?.errors">{{'ISBA.GENERAL-DATA.REPRESENTATIVE.PHONE.ERROR' | translate}}</mat-error>
                    </mat-form-field>
                </section>
            </mat-expansion-panel>

            <!-- Canal de notificaciones -->
            <mat-expansion-panel [disabled]="!rgpdAccepted" [expanded]="rgpdAccepted">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'ISBA.NOTIFICATION-CHANNEL.TITLE' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'ISBA.NOTIFICATION-CHANNEL.DESCRIPTION' | translate}} <mat-icon>email</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section ngClass="form notification-channel">
                    <section>
                        <p [innerHTML]="'ISBA.NOTIFICATION-CHANNEL.INFO' | translate"></p>
                    </section>
                    <section ngClass="inputs">
                        <mat-form-field>
                            <mat-label>{{'ISBA.NOTIFICATION-CHANNEL.PHONE.LABEL' | translate}}</mat-label>
                            <input matInput type="tel" maxlength="9" minlength="9" formControlName="tel_representante" (blur)="cleanBlank($event)">
                            <mat-error *ngIf="isbaForm.get('tel_representante')?.errors">{{'ISBA.NOTIFICATION-CHANNEL.PHONE.ERROR' | translate}}</mat-error>
                        </mat-form-field>
                        <mat-form-field>
                            <mat-label>{{'ISBA.NOTIFICATION-CHANNEL.EMAIL.LABEL' | translate}}</mat-label>
                            <input matInput type="email" formControlName="mail_representante" (blur)="cleanBlank($event)">
                            <mat-error *ngIf="isbaForm.get('mail_representante')?.errors">{{'ISBA.NOTIFICATION-CHANNEL.EMAIL.ERROR' | translate}}</mat-error>
                        </mat-form-field>
                    </section>
                </section>
            </mat-expansion-panel>

            <!-- Datos de la operación financiera -->
            <mat-expansion-panel [disabled]="!rgpdAccepted" [expanded]="rgpdAccepted">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'ISBA.FINANCIAL-DATA.TITLE' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'ISBA.FINANCIAL-DATA.DESCRIPTION' | translate}} <mat-icon>account_balance</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section ngClass="form financial-data">
                <mat-form-field>
                    <mat-label>{{'ISBA.FINANCIAL-DATA.ENTITY-NAME.LABEL' | translate}}</mat-label>
                    <input matInput type="text" formControlName="nom_entidad">
                    <mat-error *ngIf="isbaForm.get('nom_entidad')?.errors">{{'ISBA.FINANCIAL-DATA.ENTITY-NAME.ERROR' | translate}}</mat-error>
                </mat-form-field>
                <mat-form-field>
                    <mat-label>{{'ISBA.FINANCIAL-DATA.TRANSACTION-AMOUNT.LABEL' | translate}}</mat-label>
                    <input matInput type="decimal" formControlName="importe_prestamo" min="1" (blur)="cleanBlank($event)">
                    <mat-error *ngIf="isbaForm.get('importe_prestamo')?.errors">{{'ISBA.FINANCIAL-DATA.TRANSACTION-AMOUNT.ERROR' | translate}}</mat-error>
                </mat-form-field>
                <mat-form-field>
                    <mat-label>{{'ISBA.FINANCIAL-DATA.LOAN-TERM.LABEL' | translate}}</mat-label>
                    <input matInput type="number" min="1" formControlName="plazo_prestamo">
                    <mat-error *ngIf="isbaForm.get('plazo_prestamo')?.errors">{{'ISBA.FINANCIAL-DATA.LOAN-TERM.ERROR' | translate}}</mat-error>
                </mat-form-field>
                <mat-form-field>
                    <mat-label>{{'ISBA.FINANCIAL-DATA.FORMALIZATION-DATE.LABEL' | translate}}</mat-label>
                    <input matInput type="date" formControlName="fecha_aval_isba">
                    <mat-error *ngIf="isbaForm.get('fecha_aval_isba')?.errors">{{'ISBA.FINANCIAL-DATA.FORMALIZATION-DATE.ERROR' | translate}}</mat-error>
                </mat-form-field>
                <mat-form-field>
                    <mat-label>{{'ISBA.FINANCIAL-DATA.AVAL-TERM.LABEL' | translate}}</mat-label>
                    <input matInput type="number" min="1" formControlName="plazo_aval_isba">
                    <mat-error *ngIf="isbaForm.get('plazo_aval_isba')?.errors">{{'ISBA.FINANCIAL-DATA.AVAL-TERM.ERROR' | translate}}</mat-error>
                </mat-form-field>
                <mat-form-field>
                    <mat-label>{{'ISBA.FINANCIAL-DATA.AVAL-AMOUNT.LABEL' | translate}}</mat-label>
                    <input matInput type="decimal" formControlName="cuantia_aval_isba" min="1" (blur)="cleanBlank($event)">
                    <mat-error *ngIf="isbaForm.get('cuantia_aval_isba')?.errors">{{'ISBA.FINANCIAL-DATA.AVAL-AMOUNT.ERROR' | translate}}</mat-error>
                </mat-form-field>
                </section>
            </mat-expansion-panel>

            <!-- Proyecto de inversión y presupuesto -->
            <mat-expansion-panel [disabled]="!rgpdAccepted" [expanded]="rgpdAccepted">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'ISBA.PROJECT-BUDGET.TITLE' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'ISBA.PROJECT-BUDGET.DESCRIPTION' | translate}} <mat-icon>request_quote</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section ngClass="form project-budget">
                    <mat-form-field>
                        <mat-label>{{'ISBA.PROJECT-BUDGET.PURPOSE.LABEL' | translate}}</mat-label>
                        <input matInput type="text" formControlName="finalidad_inversion_idi_isba">
                        <mat-error *ngIf="isbaForm.get('finalidad_inversion_idi_isba')?.errors">{{'ISBA.PROJECT-BUDGET.PURPOSE.ERROR' | translate}}</mat-error>
                    </mat-form-field>
                    <section>
                        <mat-label>{{'ISBA.PROJECT-BUDGET.IN-ILS.LABEL' | translate}}*</mat-label>
                        <section>
                            <mat-radio-group formControlName="empresa_eco_idi_isba">
                                <mat-radio-button value="NO">{{'ISBA.PROJECT-BUDGET.IN-ILS.NO' | translate}}</mat-radio-button>
                                <mat-radio-button value="SI">{{'ISBA.PROJECT-BUDGET.IN-ILS.YES' | translate}}</mat-radio-button>
                            </mat-radio-group>
                        </section>
                    </section>
                    <section ngClass="afterFormChange" *ngIf="isbaForm.get('empresa_eco_idi_isba')?.value === 'SI'">
                        <small>{{'ISBA.PROJECT-BUDGET.IN-ILS.YES-INFO' | translate}}</small>
                    </section>
                    <mat-form-field>
                        <mat-label>{{'ISBA.PROJECT-BUDGET.BUDGET-AMOUNT.LABEL' | translate}}</mat-label>
                        <input matInput type="decimal" (blur)="cleanBlank($event)" min="0" formControlName="importe_presupuesto_idi_isba" (blur)="checkTotalAmount()">
                        <mat-error *ngIf="isbaForm.get('importe_presupuesto_idi_isba')?.errors">{{'ISBA.PROJECT-BUDGET.BUDGET-AMOUNT.ERROR' | translate}}</mat-error>
                    </mat-form-field>
                    <p><strong>{{'ISBA.PROJECT-BUDGET.BUDGET-AMOUNT.DETAILS' | translate}}</strong></p>
                    <mat-form-field>
                        <mat-label>{{'ISBA.PROJECT-BUDGET.BUDGET-AMOUNT.INTEREST-SUBSIDY' | translate}}</mat-label>
                        <input matInput type="decimal" (blur)="cleanBlank($event)" min="0" formControlName="intereses_ayuda_solicita_idi_isba" (blur)="checkTotalAmount()">
                        <mat-error *ngIf="isbaForm.get('intereses_ayuda_solicita_idi_isba')?.errors">{{((isbaForm.get('intereses_ayuda_solicita_idi_isba')?.hasError('notEqualError') ? 'ISBA.PROJECT-BUDGET.BUDGET-AMOUNT.NOT-EQUAL-SUM-ERROR' : 'ISBA.PROJECT-BUDGET.SUBSIDY-ERROR') | translate)}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'ISBA.PROJECT-BUDGET.BUDGET-AMOUNT.COST-SUBSIDY' | translate}}</mat-label>
                        <input matInput type="decimal" (blur)="cleanBlank($event)" min="0" formControlName="coste_aval_solicita_idi_isba" (blur)="checkTotalAmount()">
                        <mat-error *ngIf="isbaForm.get('coste_aval_solicita_idi_isba')?.errors">{{((isbaForm.get('coste_aval_solicita_idi_isba')?.hasError('notEqualError') ? 'ISBA.PROJECT-BUDGET.BUDGET-AMOUNT.NOT-EQUAL-SUM-ERROR' : 'ISBA.PROJECT-BUDGET.SUBSIDY-ERROR') | translate)}}</mat-error>                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'ISBA.PROJECT-BUDGET.BUDGET-AMOUNT.START-STUDY-SUBSIDY' | translate}}</mat-label>
                        <input matInput type="decimal" (blur)="cleanBlank($event)" min="0" formControlName="gastos_aval_solicita_idi_isba" (blur)="checkTotalAmount()">
                        <mat-error *ngIf="isbaForm.get('gastos_aval_solicita_idi_isba')?.errors">{{((isbaForm.get('gastos_aval_solicita_idi_isba')?.hasError('notEqualError') ? 'ISBA.PROJECT-BUDGET.BUDGET-AMOUNT.NOT-EQUAL-SUM-ERROR' : 'ISBA.PROJECT-BUDGET.SUBSIDY-ERROR') | translate)}}</mat-error>                    </mat-form-field>
                </section>
                <section style="padding-bottom: 1.1rem;">
                    <dl><h4>{{'ISBA.PROJECT-BUDGET.REQUEST.TITLE' | translate}}</h4></dl>
                    <dt>{{'ISBA.PROJECT-BUDGET.REQUEST.INFO' | translate}}</dt>
                </section>
                <section ngClass="form project-budget">
                    <mat-form-field>
                        <mat-label>{{'ISBA.PROJECT-BUDGET.REQUEST.LABEL' | translate}}</mat-label>
                        <input matInput type="decimal" (blur)="cleanBlank($event); checkAmount()" min="0" formControlName="importe_ayuda_solicita_idi_isba">
                        <mat-error *ngIf="isbaForm.get('importe_ayuda_solicita_idi_isba')?.errors">{{'ISBA.PROJECT-BUDGET.REQUEST.ERROR' | translate}}</mat-error>
                    </mat-form-field>
                </section>
            </mat-expansion-panel>

            <!-- Declaracion responsable -->
            <mat-expansion-panel [disabled]="!rgpdAccepted" [expanded]="rgpdAccepted">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'ISBA.DECLARATIONS.TITLE' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'ISBA.DECLARATIONS.DESCRIPTION' | translate}} <mat-icon>menu_book</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section ngClass="form declaration-checkboxes">
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_0"><label>1. {{'ISBA.DECLARATIONS.DECLARATION-1' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_1"><label>2. {{'ISBA.DECLARATIONS.DECLARATION-2' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_2"><label>3. {{'ISBA.DECLARATIONS.DECLARATION-3' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_3"><label>4. {{'ISBA.DECLARATIONS.DECLARATION-4' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_4"><label>5. {{'ISBA.DECLARATIONS.DECLARATION-5' | translate}}</label></mat-checkbox>
                    <section ngClass="afterFormChange" *ngIf="!ayudasSubvenciones">
                        <mat-form-field>
                            <mat-label>{{'ISBA.DECLARATIONS.DECLARATION-5-NO.LABEL' | translate}}</mat-label>
                            <input matInput type="text" formControlName="ayudasSubvenSICuales_dec_resp">
                            <mat-error *ngIf="isbaForm.get('ayudasSubvenSICuales_dec_resp')?.errors">{{'ISBA.DECLARATIONS.DECLARATION-5-NO.ERROR' | translate}}</mat-error>
                        </mat-form-field>
                    </section>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_5"><label>6. {{'ISBA.DECLARATIONS.DECLARATION-6' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_7"><label>7. {{'ISBA.DECLARATIONS.DECLARATION-7' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_8"><label>8. {{'ISBA.DECLARATIONS.DECLARATION-8' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_10"><label>9. {{'ISBA.DECLARATIONS.DECLARATION-9' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_12"><label>10. {{'ISBA.DECLARATIONS.DECLARATION-10' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_13"><label>11. {{'ISBA.DECLARATIONS.DECLARATION-11' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_14"><label>12. {{'ISBA.DECLARATIONS.DECLARATION-12' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_15"><label>13. {{'ISBA.DECLARATIONS.DECLARATION-13' | translate}}</label></mat-checkbox>
                </section>
            </mat-expansion-panel>

             <!-- Documentación -->
            <mat-expansion-panel [disabled]="!rgpdAccepted" [expanded]="rgpdAccepted">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'ISBA.DOCUMENTATION.TITLE' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'ISBA.DOCUMENTATION.DESCRIPTION' | translate}} <mat-icon>attachment</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section>
                    <p [innerHTML]="'ISBA.DOCUMENTATION.INFO.FORMAT-INFO' | translate"></p>
                    <ol>
                        <li [innerHTML]="'ILS.DOCUMENTATION.INFO.CTRL-INFO' | translate"></li>
                        <li [innerHTML]="'ILS.DOCUMENTATION.INFO.SHIFT-INFO' | translate"></li>
                    </ol>
                </section>
                <section>
                    <section ngClass="form documentation">
                        <section ngClass="file-input">
                            <p>{{'ISBA.DOCUMENTATION.DOC-1' | translate}}</p>
                        </section>
                        <section ngClass="file-input">
                            <mat-form-field floatLabel="always">
                                <mat-label>{{'ISBA.DOCUMENTATION.DOC-2' | translate}}</mat-label>
                                <input 
                                matInput
                                type="text"
                                formControlName="file_memoriaTecnica"
                                readonly
                                [value]="fileNames['file_memoriaTecnica']"
                                (click)="file_memoriaTecnica.click()"
                                placeholder="{{'COMMON.FILE.UPLOAD' | translate}}"
                                />
                                <mat-error *ngIf="isbaForm.get('file_memoriaTecnica')?.errors">{{'COMMON.FILE.ERROR' | translate}}</mat-error>
                            </mat-form-field>
                            <input #file_memoriaTecnica type="file" (change)="onFileChange($event, 'file_memoriaTecnica')" hidden accept=".pdf, .jpeg, .png" multiple>
                            <ul *ngIf="files['file_memoriaTecnica'].length > 0">
                                <li *ngFor="let file of files['file_memoriaTecnica']">{{file.name}} {{file.size/1000}} KB</li>
                            </ul>
                            
                        </section>
                        <section ngClass="file-input">
                            <mat-form-field floatLabel="always">
                                <mat-label>{{'ISBA.DOCUMENTATION.DOC-3' | translate}}</mat-label>
                                <input 
                                matInput
                                type="text"
                                formControlName="file_document_veracidad_datos_bancarios"
                                readonly
                                [value]="fileNames['file_document_veracidad_datos_bancarios']"
                                (click)="file_document_veracidad_datos_bancarios.click()"
                                placeholder="{{'COMMON.FILE.UPLOAD' | translate}}"
                                />
                                <mat-error *ngIf="isbaForm.get('file_document_veracidad_datos_bancarios')?.errors">{{'COMMON.FILE.ERROR' | translate}}</mat-error>
                            </mat-form-field>
                            <input #file_document_veracidad_datos_bancarios type="file" (change)="onFileChange($event, 'file_document_veracidad_datos_bancarios')" hidden accept=".pdf, .jpeg, .png" multiple>
                            <ul *ngIf="files['file_document_veracidad_datos_bancarios'].length > 0">
                                <li *ngFor="let file of files['file_document_veracidad_datos_bancarios']">{{file.name}} {{file.size/1000}} KB</li>
                            </ul>
                        </section>
                        <section ngClass="file-input">
                            <mat-form-field floatLabel="always">
                                <mat-label>{{'ISBA.DOCUMENTATION.DOC-4' | translate}}</mat-label>
                                <input 
                                matInput
                                type="text"
                                formControlName="file_certificadoIAE"
                                readonly
                                [value]="fileNames['file_certificadoIAE']"
                                (click)="file_certificadoIAE.click()"
                                placeholder="{{'COMMON.FILE.UPLOAD' | translate}}"
                                />
                                <mat-error *ngIf="isbaForm.get('file_certificadoIAE')?.errors">{{'COMMON.FILE.ERROR' | translate}}</mat-error>
                            </mat-form-field>
                            <input #file_certificadoIAE type="file" (change)="onFileChange($event, 'file_certificadoIAE')" hidden accept=".pdf, .jpeg, .png" multiple>
                            <ul *ngIf="files['file_certificadoIAE'].length > 0">
                                <li *ngFor="let file of files['file_certificadoIAE']">{{file.name}} {{file.size/1000}} KB</li>
                            </ul>
                        </section>

                        <!-- Persona física -->
                        <section ngClass="file-input" *ngIf="businessType === 'autonomo'">
                            <p [innerHTML]="'ISBA.DOCUMENTATION.DOC-5.TITLE' | translate"></p>
                            <mat-form-field floatLabel="always">
                                <mat-label [innerHTML]="'ISBA.DOCUMENTATION.DOC-5.DOC' | translate"></mat-label>
                                <input 
                                matInput
                                type="text"
                                formControlName="file_altaAutonomos"
                                readonly
                                [value]="fileNames['file_altaAutonomos']"
                                (click)="file_altaAutonomos.click()"
                                placeholder="{{'COMMON.FILE.UPLOAD' | translate}}"
                                />
                                <mat-error *ngIf="isbaForm.get('file_altaAutonomos')?.errors">{{'COMMON.FILE.ERROR' | translate}}</mat-error>
                            </mat-form-field>
                            <input #file_altaAutonomos type="file" (change)="onFileChange($event, 'file_altaAutonomos')" hidden accept=".pdf, .jpeg, .png" multiple>
                            <ul *ngIf="files['file_altaAutonomos'].length > 0">
                                <li *ngFor="let file of files['file_altaAutonomos']">{{file.name}} {{file.size/1000}} KB</li>
                            </ul>
                        </section>

                        <!-- Persona jurídica -->
                        <section ngClass="file-input" *ngIf="businessType !== 'autonomo'">
                            <dl>
                                <dt [innerHTML]="'ISBA.DOCUMENTATION.DOC-6.TITLE' | translate"></dt>
                                <dd>{{'ISBA.DOCUMENTATION.DOC-6.DOC-1' | translate}}</dd>
                                <dd>{{'ISBA.DOCUMENTATION.DOC-6.DOC-2' | translate}}</dd>
                            </dl>
                            <mat-form-field floatLabel="always">
                                <mat-label [innerHTML]="'ISBA.DOCUMENTATION.DOC-6.LABEL' | translate"></mat-label>
                                <input 
                                matInput
                                type="text"
                                formControlName="file_escrituraConstitucion"
                                readonly
                                [value]="fileNames['file_escrituraConstitucion']"
                                (click)="file_escrituraConstitucion.click()"
                                placeholder="{{'COMMON.FILE.UPLOAD' | translate}}"
                                />
                                <mat-error *ngIf="isbaForm.get('file_escrituraConstitucion')?.errors">{{'COMMON.FILE.ERROR' | translate}}</mat-error>
                            </mat-form-field>
                            <input #file_escrituraConstitucion type="file" (change)="onFileChange($event, 'file_escrituraConstitucion')" hidden accept=".pdf, .jpeg, .png" multiple>
                            <ul *ngIf="files['file_escrituraConstitucion'].length > 0">
                                <li *ngFor="let file of files['file_escrituraConstitucion']">{{file.name}} {{file.size/1000}} KB</li>
                            </ul>
                        </section>

                        <section ngClass="file-input">
                            <p>{{'ISBA.DOCUMENTATION.DOC-7.DOC-INFO' | translate}}</p>
                            <mat-checkbox formControlName="dni_no_consent" style="padding-bottom: 10px;">
                                <label>{{'COMMON.NO-CONSENT' | translate}}</label>
                            </mat-checkbox>
                            <section ngClass="afterFormChange" *ngIf="dni_no_consent">
                                <mat-form-field floatLabel="always">
                                    <mat-label>{{'ISBA.DOCUMENTATION.DOC-7.LABEL' | translate}}</mat-label>
                                    <input 
                                    matInput
                                    type="text"
                                    formControlName="file_nifRepresentante"
                                    readonly
                                    [value]="fileNames['file_nifRepresentante']"
                                    (click)="file_nifRepresentante.click()"
                                    placeholder="{{'COMMON.FILE.UPLOAD' | translate}}"
                                    />
                                    <mat-error *ngIf="isbaForm.get('file_nifRepresentante')?.errors">{{'COMMON.FILE.ERROR' | translate}}</mat-error>
                                </mat-form-field>
                            </section>
                            <input #file_nifRepresentante type="file" (change)="onFileChange($event, 'file_nifRepresentante')" hidden accept=".pdf, .jpeg, .png" multiple>
                            <ul *ngIf="files['file_nifRepresentante'].length > 0">
                                <li *ngFor="let file of files['file_nifRepresentante']">{{file.name}} {{file.size/1000}} KB</li>
                            </ul>
                        </section>

                        <section ngClass="file-input">
                            <p>{{'ISBA.DOCUMENTATION.DOC-8.DOC-INFO' | translate}}</p>
                            <mat-checkbox formControlName="atib_no_consent" style="padding-bottom: 10px;">
                                <label>{{'COMMON.NO-CONSENT' | translate}}</label>
                            </mat-checkbox>
                            <section ngClass="afterFormChange" *ngIf="atib_no_consent">
                                <mat-form-field floatLabel="always">
                                    <mat-label>{{'ISBA.DOCUMENTATION.DOC-8.LABEL' | translate}}</mat-label>
                                    <input 
                                    matInput
                                    type="text"
                                    formControlName="file_certificadoATIB"
                                    readonly
                                    [value]="fileNames['file_certificadoATIB']"
                                    (click)="file_certificadoATIB.click()"
                                    placeholder="{{'COMMON.FILE.UPLOAD' | translate}}"
                                    />
                                    <mat-error *ngIf="isbaForm.get('file_certificadoATIB')?.errors">{{'COMMON.FILE.ERROR' | translate}}</mat-error>
                                </mat-form-field>
                            </section>
                            <input #file_certificadoATIB type="file" (change)="onFileChange($event, 'file_certificadoATIB')" hidden accept=".pdf, .jpeg, .png" multiple>
                            <ul *ngIf="files['file_certificadoATIB'].length > 0">
                                <li *ngFor="let file of files['file_certificadoATIB']">{{file.name}} {{file.size/1000}} KB</li>
                            </ul>
                        </section>
                        <section ngClass="file-input">
                            <mat-form-field floatLabel="always">
                                <mat-label>{{'ISBA.DOCUMENTATION.DOC-9' | translate}}</mat-label>
                                <input 
                                matInput
                                type="text"
                                formControlName="file_certificadoAEAT"
                                readonly
                                [value]="fileNames['file_certificadoAEAT']"
                                (click)="file_certificadoAEAT.click()"
                                placeholder="{{'COMMON.FILE.UPLOAD' | translate}}"
                                />
                                <mat-error *ngIf="isbaForm.get('file_certificadoAEAT')?.errors">{{'COMMON.FILE.ERROR' | translate}}</mat-error>
                            </mat-form-field>
                            <input #file_certificadoAEAT type="file" (change)="onFileChange($event, 'file_certificadoAEAT')" hidden accept=".pdf, .jpeg, .png" multiple>
                            <ul *ngIf="files['file_certificadoAEAT'].length > 0">
                                <li *ngFor="let file of files['file_certificadoAEAT']">{{file.name}} {{file.size/1000}} KB</li>
                            </ul>
                        </section>
                        <section ngClass="file-input" *ngIf="isSubsidyGreater">
                            <mat-form-field floatLabel="always">
                                <mat-label>{{'ISBA.DOCUMENTATION.DOC-10' | translate}}</mat-label>
                                <input 
                                matInput
                                type="text"
                                formControlName="file_certificadoLey382003"
                                readonly
                                [value]="fileNames['file_certificadoLey382003']"
                                (click)="file_certificadoLey382003.click()"
                                placeholder="{{'COMMON.FILE.UPLOAD' | translate}}"
                                />
                                <mat-error *ngIf="isbaForm.get('file_certificadoLey382003')?.errors">{{'COMMON.FILE.ERROR' | translate}}</mat-error>
                            </mat-form-field>
                            <input #file_certificadoLey382003 type="file" (change)="onFileChange($event, 'file_certificadoLey382003')" hidden accept=".pdf, .jpeg, .png" multiple>
                            <ul *ngIf="files['file_certificadoLey382003'].length > 0">
                                <li *ngFor="let file of files['file_certificadoLey382003']">{{file.name}} {{file.size/1000}} KB</li>
                            </ul>
                        </section>
                        <section ngClass="file-input">
                            <mat-form-field floatLabel="always">
                                <mat-label>{{'ISBA.DOCUMENTATION.DOC-11' | translate}}</mat-label>
                                <input 
                                matInput
                                type="text"
                                formControlName="file_certificadoSGR"
                                readonly
                                [value]="fileNames['file_certificadoSGR']"
                                (click)="file_certificadoSGR.click()"
                                placeholder="{{'COMMON.FILE.UPLOAD' | translate}}"
                                />
                                <mat-error *ngIf="isbaForm.get('file_certificadoSGR')?.errors">{{'COMMON.FILE.ERROR' | translate}}</mat-error>
                            </mat-form-field>
                            <input #file_certificadoSGR type="file" (change)="onFileChange($event, 'file_certificadoSGR')" hidden accept=".pdf, .jpeg, .png" multiple>
                            <ul *ngIf="files['file_certificadoSGR'].length > 0">
                                <li *ngFor="let file of files['file_certificadoSGR']">{{file.name}} {{file.size/1000}} KB</li>
                            </ul>
                        </section>
                        <section ngClass="file-input">
                            <mat-form-field floatLabel="always">
                                <mat-label>{{'ISBA.DOCUMENTATION.DOC-12' | translate}}</mat-label>
                                <input 
                                matInput
                                type="text"
                                formControlName="file_contratoOperFinanc"
                                readonly
                                [value]="fileNames['file_contratoOperFinanc']"
                                (click)="file_contratoOperFinanc.click()"
                                placeholder="{{'COMMON.FILE.UPLOAD' | translate}}"
                                />
                                <mat-error *ngIf="isbaForm.get('file_contratoOperFinanc')?.errors">{{'COMMON.FILE.ERROR' | translate}}</mat-error>
                            </mat-form-field>
                            <input #file_contratoOperFinanc type="file" (change)="onFileChange($event, 'file_contratoOperFinanc')" hidden accept=".pdf, .jpeg, .png" multiple>
                            <ul *ngIf="files['file_contratoOperFinanc'].length > 0">
                                <li *ngFor="let file of files['file_contratoOperFinanc']">{{file.name}} {{file.size/1000}} KB</li>
                            </ul>
                        </section>
                        <section ngClass="file-input">
                            <mat-form-field floatLabel="always">
                                <mat-label>{{'ISBA.DOCUMENTATION.DOC-13' | translate}}</mat-label>
                                <input 
                                matInput
                                type="text"
                                readonly
                                [value]="fileNames['file_avalOperFinanc']"
                                (click)="file_avalOperFinanc.click()"
                                placeholder="{{'COMMON.FILE.UPLOAD' | translate}}"
                                formControlName="file_avalOperFinanc"
                                />

                                <mat-error *ngIf="isbaForm.get('file_avalOperFinanc')?.errors">{{'COMMON.FILE.ERROR' | translate}}</mat-error>
                            </mat-form-field>
                            <input #file_avalOperFinanc type="file" (change)="onFileChange($event, 'file_avalOperFinanc')" hidden accept=".pdf, .jpeg, .png" multiple>
                            <ul *ngIf="files['file_avalOperFinanc'].length > 0">
                                <li *ngFor="let file of files['file_avalOperFinanc']">{{file.name}} {{file.size/1000}} KB</li>
                            </ul>
                        </section>
                        <section ngClass="file-input">
                            <p>{{'ISBA.DOCUMENTATION.DOC-14' | translate}}</p>
                        </section>
                    </section>
                </section>
            </mat-expansion-panel>
        </mat-accordion>
        <mat-form-field style="display: none">
            <input matInput type="text" formControlName="tipo_tramite">
        </mat-form-field>
        <button mat-raised-button color="primary" type="submit" [disabled]="isbaForm.invalid">{{'COMMON.SEND' | translate}}</button>
    </form>
</section>