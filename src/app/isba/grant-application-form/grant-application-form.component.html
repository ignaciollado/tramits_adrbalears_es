<section ngClass="logo-area">
    <a href="https://www.isbasgr.es/es/" target="_blank"><img src="/assets/images/logo-isba-sgr-317.png" alt="Logo de ISBA" width="30%"></a>
    <a href="https://www.adrbalears.es/es/" target="_blank" ngClass="adrLogo"><img src="/assets/images/logo-adrbalears-ceae-byn.png" alt="Logo de ADR Balears" width="60%"></a>
</section>
<section ngClass="info-header">
    <section>
        <h2>{{'ISBA.TITLE' | translate}}</h2>
        <p ngClass="banner"><strong>{{'ISBA.INFO.BANNER' | translate}}</strong></p>
    </section>
    <section ngClass="info">
        <dd>
            <dl [innerHTML]="'ISBA.INFO.DESTINATION' | translate"></dl>
            <dl [innerHTML]="'ISBA.INFO.EMITTER' | translate"></dl>
            <dl [innerHTML]="'ISBA.INFO.SIA-CODE' | translate"></dl>
            <dl [innerHTML]="'ISBA.INFO.PROCEDURE' | translate"></dl>
        </dd>
    </section>
</section>
<section>
    <form [formGroup]="isbaForm" ngClass="form" (ngSubmit)="onSubmit()">
        <section ngClass="button-area">
            <section>
                <button type="button" matButton ngClass="btn-adr btn" (click)="accordion().openAll()">{{ 'XECS.EXPANDALL' | translate }}</button>
                <button type="button" matButton ngClass="btn-adr btn" (click)="accordion().closeAll()">{{ 'XECS.COLAPSEALL' | translate }}</button>
            </section>
            <section>
                <button type="button" matButton class="btn-adr btn" (click)="changeLanguage('es-ES')" [ngClass]="{selected: actualLang === 'es-ES'}">Castellano</button>
                <button type="button" matButton class="btn-adr btn" (click)="changeLanguage('ca-ES')" [ngClass]="{selected: actualLang === 'ca-ES'}">Català</button>
            </section>
        </section>
        <mat-accordion ngClass="example-headers-align" multi>
            <!-- RGPD -->
            <mat-expansion-panel [expanded]="step() === 0" (opened)="setStep(0)">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'FORM.RGPDTITLE' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'FORM.RGPDDESCRIPTION' | translate}} <mat-icon>policy</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section>
                    <mat-checkbox formControlName="acceptRGPD">
                        <label>
                            {{'COMMON.RGPD-INFO.READ-AND-ACCEPTS.PART-1' | translate}}<abbr title="{{'COMMON.ACRONYMS.RGPD.FULL-PHRASE' | translate}}">{{'COMMON.ACRONYMS.RGPD.ACRONYM' | translate}}.</abbr><mat-icon data-icon="rgpd-icon" (click)="openDialog('300ms', '300ms', 'Sobre el RGPD', '../../../assets/data/clausulaProteccionDatos-es.html', '', '')">info</mat-icon>{{'COMMON.RGPD-INFO.READ-AND-ACCEPTS.PART-2' | translate}}<abbr title="{{'COMMON.ACRONYMS.ADR.FULL-PHRASE' | translate}}">{{'COMMON.ACRONYMS.ADR.ACRONYM' | translate}}</abbr>{{'COMMON.RGPD-INFO.READ-AND-ACCEPTS.PART-3' | translate}}<mat-icon data-icon="rgpd-info" (click)="openDialog('300ms', '300ms', 'Nuestra política de privacidad', '../../../assets/data/politica_privacidad.html', '', '')">info</mat-icon>
                        </label>
                    </mat-checkbox>
                    <section>
                        <p>{{'ISBA.REQUIREDDOCINFO' | translate}}</p>
                        <ol>
                            <li>{{'ISBA.REQUIREDDOC1' | translate}}</li>
                            <li>{{'ISBA.REQUIREDDOC2' | translate}}</li>
                            <li>{{'ISBA.REQUIREDDOC3' | translate}}</li>
                            <li>{{'ISBA.REQUIREDDOC4PART1' | translate}}<abbr title="{{'COMMON.ACRONYMS.BAT.FULL-PHRASE' | translate}}">{{'COMMON.ACRONYMS.BAT.ACRONYM' | translate}}</abbr>{{'ISBA.REQUIREDDOC4PART2' | translate}}</li>
                            <li>
                                {{'ISBA.REQUIREDDOC5INFO' | translate}}
                                <ol>
                                    <li type="a">{{'ISBA.REQUIREDDOC5DOC' | translate}}</li>
                                </ol>
                            </li>
                            <li>
                                {{'ISBA.REQUIREDDOC6INFO' | translate}}
                                <ol>
                                    <li type="a">{{'ISBA.REQUIREDDOC6DOC1' | translate}}</li>
                                    <li type="a">{{'ISBA.REQUIREDDOC6DOC2' | translate}}</li>
                                </ol>
                            </li>
                            <li>{{'ISBA.REQUIREDDOC7' | translate}}</li>
                            <li>{{'ISBA.REQUIREDDOC8PART1' | translate}}<abbr title="{{'COMMON.ACRONYMS.ATIB.FULL-PHRASE' | translate}}">{{'COMMON.ACRONYMS.ATIB.ACRONYM' | translate}}</abbr>{{'ISBA.REQUIREDDOC8PART2' | translate}}<abbr title="{{'COMMON.ACRONYMS.ADR.FULL-PHRASE' | translate}}">{{'COMMON.ACRONYMS.ADR.ACRONYM' | translate}}</abbr>{{'ISBA.REQUIREDDOC8PART3' | translate}}<abbr title="{{'COMMON.ACRONYMS.ATIB.FULL-PHRASE' | translate}}">{{'COMMON.ACRONYMS.ATIB.ACRONYM' | translate}}</abbr>{{'ISBA.REQUIREDDOC8PART4' | translate}}<abbr title="{{'COMMON.ACRONYMS.TGSS.FULL-PHRASE' | translate}}">{{'COMMON.ACRONYMS.TGSS.ACRONYM' | translate}}</abbr>{{'ISBA.REQUIREDDOC8PART5' | translate}}</li>
                            <li>{{'ISBA.REQUIREDDOC9' | translate}}</li>
                            <li>{{'ISBA.REQUIREDDOC10' | translate}}</li>
                            <li>{{'ISBA.REQUIREDDOC11' | translate}}</li>
                            <li>{{'ISBA.REQUIREDDOC12' | translate}}</li>
                            <li>{{'ISBA.REQUIREDDOC13' | translate}}</li>
                            <li>{{'ISBA.REQUIREDDOC14' | translate}}</li>
                        </ol>

                        <dl>
                            <dt>{{'ISBA.NOTIFICATIONINFO' | translate}}</dt>
                            <dd>{{'ISBA.NOTIFICATIONDOC1' | translate}}</dd>
                            <dd>{{'ISBA.NOTIFICATIONDOC2' | translate}}</dd>
                        </dl>
                    </section>
                </section>
            </mat-expansion-panel>

            <!-- Tipo Solicitante-->
            <mat-expansion-panel [disabled]="!rgpdAccepted" [expanded]="rgpdAccepted">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'FORM.SOLICITORTYPE' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'FORM.ORGANIZATIONTYPE' | translate}} <mat-icon>corporate_fare</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section ngClass="form applicant-type">
                    <section>
                        <mat-radio-group formControlName="tipo_solicitante">
                            <mat-radio-button value="autonomo">{{'FORM.SELFEMPLOYEDBUSINESS' | translate}}</mat-radio-button>
                            <mat-radio-button value="pequenya">{{'FORM.SMALLBUSINESSNAME' | translate}}</mat-radio-button>
                            <mat-radio-button value="mediana">{{'FORM.MEDIUMBUSINESSNAME' | translate}}</mat-radio-button>
                        </mat-radio-group>
                    </section>
                    <section>
                        <p><strong>{{'FORM.SMALLBUSINESSNAME' | translate}}</strong>: {{'FORM.SMALLBUSINESSINFO' | translate}}</p>
                        <p><strong>{{'FORM.MEDIUMBUSINESSNAME' | translate}}</strong>: {{'FORM.MEDIUMBUSINESSINFO' | translate}}</p>
                    </section>
                </section>
            </mat-expansion-panel>

            <!-- Datos generales -->
            <mat-expansion-panel [disabled]="!rgpdAccepted" [expanded]="rgpdAccepted">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'FORM.SOLICITOR' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'FORM.SOLICITORDETAILS' | translate}} <mat-icon>person</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section ngClass="form personal-data">
                    <mat-form-field>
                        <mat-label *ngIf="businessType === 'autonomo'">{{'FORM.NIF' | translate}}</mat-label>
                        <mat-label *ngIf="businessType !== 'autonomo'">{{'FORM.CIF' | translate}}</mat-label>
                            <input matInput type="text" formControlName="nif" maxlength="9">
                            <mat-error *ngIf="isbaForm.get('nif')?.errors && businessType==='autonomo'">{{'FORMERRORS.COMMON.NIF' | translate}}</mat-error>
                            <mat-error *ngIf="isbaForm.get('nif')?.errors && businessType!=='autonomo'">{{'FORMERRORS.COMMON.CIF' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'FORM.COMPANYNAME' | translate}}</mat-label>
                        <input matInput type="text" formControlName="empresa">
                        <mat-error *ngIf="isbaForm.get('empresa')?.errors" >{{'FORMERRORS.COMMON.COMPANYNAME' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'FORM.ADDRESS' | translate}}</mat-label>
                        <input matInput type="text" formControlName="domicilio">
                        <mat-error *ngIf="isbaForm.get('domicilio')?.errors">{{'FORMERRORS.COMMON.ADDRESS' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'FORM.ZIPCODE' | translate}}</mat-label>
                        <input matInput (ngModelChange)="selectedValue()" type="text" formControlName="cpostal" maxlength="5" minlength="5" [matAutocomplete]="auto" (blur)="cleanBlank($event)">
                        <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
                            <mat-option *ngFor="let option of filteredOptions | async" [value]="option">{{option.zipCode}} {{option.town}}</mat-option> 
                        </mat-autocomplete>
                        <mat-error *ngIf="isbaForm.get('cpostal')?.errors">{{'FORMERRORS.COMMON.ZIPCODE' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'FORM.TOWN' | translate}}</mat-label>
                        <input matInput formControlName="localidad" readonly>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'FORM.CONTACTPHONE' | translate}}</mat-label>
                        <input matInput type="tel" formControlName="telefono" (blur)="cleanBlank($event)" minlength="9" maxlength="9">
                        <mat-error *ngIf="isbaForm.get('telefono')?.errors">{{'FORMERRORS.COMMON.CONTACTPHONE' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'FORM.SELECTIAE' | translate}}</mat-label>
                        <mat-select formControlName="iae">
                            <mat-option *ngFor="let actividad of actividadesCNAE" [value]="actividad.cnae">{{actividad.label_cas}}</mat-option>
                        </mat-select>
                        <mat-error *ngIf="isbaForm.get('iae')?.errors">{{'FORMERRORS.COMMON.CNAECODE' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'FORM.NOMREPRESENTANTE' | translate}}</mat-label>
                        <input matInput type="text" formControlName="nombre_rep">
                        <mat-error *ngIf="isbaForm.get('nombre_rep')?.errors">{{'FORMERRORS.COMMON.NAMEREPRESENTANTE' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'FORM.NIFREPRESENTANTE' | translate}}</mat-label>
                        <input matInput type="text" formControlName="nif_rep" maxlength="9" minlength="9">
                        <mat-error *ngIf="isbaForm.get('nif_rep')?.errors">{{'FORMERRORS.COMMON.NIFREPRESENTANTE' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'ISBA.PHONEREPRESENTANTE' | translate}}</mat-label>
                        <input matInput type="tel" formControlName="telefono_contacto_rep" (blur)="cleanBlank($event)" maxlength="9" minlength="9">
                        <mat-error *ngIf="isbaForm.get('telefono_contacto_rep')?.errors">{{'FORMERRORS.COMMON.PHONEREPRESENTANTE' | translate}}</mat-error>
                    </mat-form-field>
                </section>
            </mat-expansion-panel>

            <!-- Canal de notificaciones -->
            <mat-expansion-panel [disabled]="!rgpdAccepted" [expanded]="rgpdAccepted">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'FORM.NOTIFICATIONCHANEL' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'FORM.NOTIFICATIONCHANELDESCRIPTION' | translate}} <mat-icon>email</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section ngClass="form notification-channel">
                    <section>
                        <p [innerHTML]="'FORM.NOTIFICATIONCHANELINFO' | translate"></p>
                    </section>
                    <section ngClass="inputs">
                        <mat-form-field>
                            <mat-label>{{'FORM.NOTIFICATIONMOBILE' | translate}}</mat-label>
                            <input matInput type="tel" maxlength="9" minlength="9" formControlName="telefono_rep" (blur)="cleanBlank($event)">
                            <mat-error *ngIf="isbaForm.get('telefono_rep')?.errors">{{'FORMERRORS.COMMON.NOTIFICATIONPHONE' | translate}}</mat-error>
                        </mat-form-field>
                        <mat-form-field>
                            <mat-label>{{'FORM.NOTIFICATIONMAIL' | translate}}</mat-label>
                            <input matInput type="email" formControlName="email_rep" (blur)="cleanBlank($event)">
                            <mat-error *ngIf="isbaForm.get('email_rep')?.errors">{{'FORMERRORS.COMMON.NOTIFICATIONEMAIL' | translate}}</mat-error>
                        </mat-form-field>
                    </section>
                </section>
            </mat-expansion-panel>

            <!-- Datos de la operación financiera -->
            <mat-expansion-panel [disabled]="!rgpdAccepted" [expanded]="rgpdAccepted">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'ISBA.FINANCIALDATA' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'ISBA.FINANCIALDATADESCRIPTION' | translate}} <mat-icon>account_balance</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section ngClass="form financial-data">
                <mat-form-field>
                    <mat-label>{{'ISBA.ENTITYNAME' | translate}}</mat-label>
                    <input matInput type="text" formControlName="nom_entidad">
                    <mat-error *ngIf="isbaForm.get('nom_entidad')?.errors">{{'FORMERRORS.ISBA.NOMBREENTIDAD' | translate}}</mat-error>
                </mat-form-field>
                <mat-form-field>
                    <mat-label>{{'ISBA.TRANSACTIONAMOUNT' | translate}}</mat-label>
                    <input matInput type="decimal" formControlName="importe_prestamo" min="1" (blur)="cleanBlank($event)">
                    <mat-error *ngIf="isbaForm.get('importe_prestamo')?.errors">{{((isbaForm.get('importe_prestamo')?.hasError('invalidDecimal') ? 'FORMERRORS.COMMON.DECIMAL' : 'FORMERRORS.ISBA.IMPORTEFINANCIERO') | translate)}}</mat-error>
                </mat-form-field>
                <mat-form-field>
                    <mat-label>{{'ISBA.LOANTERM' | translate}}</mat-label>
                    <input matInput type="number" min="1" formControlName="plazo_prestamo">
                    <mat-error *ngIf="isbaForm.get('plazo_prestamo')?.errors">{{'FORMERRORS.ISBA.PLAZOFINANCIERO' | translate}}</mat-error>
                </mat-form-field>
                <mat-form-field>
                    <mat-label>{{'ISBA.FORMALIZATIONDATE' | translate}}</mat-label>
                    <input matInput type="date" formControlName="fecha_aval_idi_isba">
                    <mat-error *ngIf="isbaForm.get('fecha_aval_idi_isba')?.errors">{{'FORMERRORS.ISBA.FORMALIZACIONAVAL' | translate}}</mat-error>
                </mat-form-field>
                <mat-form-field>
                    <mat-label>{{'ISBA.AVALTERM' | translate}}</mat-label>
                    <input matInput type="number" min="1" formControlName="plazo_aval_idi_isba">
                    <mat-error *ngIf="isbaForm.get('plazo_aval_idi_isba')?.errors">{{'FORMERRORS.ISBA.PLAZOAVAL' | translate}}</mat-error>
                </mat-form-field>
                <mat-form-field>
                    <mat-label>{{'ISBA.AVALAMOUNT' | translate}}</mat-label>
                    <input matInput type="decimal" formControlName="cuantia_aval_idi_isba" min="1" (blur)="cleanBlank($event)">
                    <mat-error *ngIf="isbaForm.get('cuantia_aval_idi_isba')?.errors">{{((isbaForm.get('cuantia_aval_idi_isba')?.hasError('invalidDecimal') ? 'FORMERRORS.COMMON.DECIMAL' : 'FORMERRORS.ISBA.IMPORTEAVAL') | translate)}}</mat-error>
                </mat-form-field>
                </section>
            </mat-expansion-panel>

            <!-- Proyecto de inversión y presupuesto -->
            <mat-expansion-panel [disabled]="!rgpdAccepted" [expanded]="rgpdAccepted">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'ISBA.PROJECTBUDGET' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'ISBA.PROJECTBUDGETDESCRIPTION' | translate}} <mat-icon>request_quote</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section ngClass="form project-budget">
                    <mat-form-field>
                        <mat-label>{{'ISBA.PROJECTPURPOSE' | translate}}</mat-label>
                        <input matInput type="text" formControlName="finalidad_inversion_idi_isba">
                        <mat-error *ngIf="isbaForm.get('finalidad_inversion_idi_isba')?.errors">{{'FORMERRORS.ISBA.PROPOSITOPROYECTO' | translate}}</mat-error>
                    </mat-form-field>
                    <section>
                        <mat-label>{{'ISBA.PROJECTINILS' | translate}}*</mat-label>
                        <section>
                            <mat-radio-group formControlName="empresa_eco_idi_isba">
                                <mat-radio-button value="NO">{{'APP.NO' | translate}}</mat-radio-button>
                                <mat-radio-button value="SI">{{'APP.YES' | translate}}</mat-radio-button>
                            </mat-radio-group>
                        </section>
                    </section>
                    <section ngClass="afterFormChange" *ngIf="isbaForm.get('empresa_eco_idi_isba')?.value === 'SI'">
                        <small>{{'ISBA.INILSYESINFO' | translate}}</small>
                    </section>
                    <mat-form-field>
                        <mat-label>{{'ISBA.BUDGETAMOUNT' | translate}}</mat-label>
                        <input matInput type="decimal" (blur)="cleanBlank($event)" min="0" formControlName="importe_presupuesto_idi_isba" (blur)="checkTotalAmount()">
                        <mat-error *ngIf="isbaForm.get('importe_presupuesto_idi_isba')?.errors">{{((isbaForm.get('importe_presupuesto_idi_isba')?.hasError('invalidDecimal') ? 'FORMERRORS.COMMON.DECIMAL' : 'FORMERRORS.ISBA.IMPORTEPRESUPUESTO') | translate)}}</mat-error>
                    </mat-form-field>
                    <p><strong>{{'ISBA.BUDGETAMOUNTDETAILS' | translate}}</strong></p>
                    <mat-form-field>
                        <mat-label>{{'ISBA.INTERESTSUBSIDY' | translate}}</mat-label>
                        <input matInput type="decimal" (blur)="cleanBlank($event)" min="0" formControlName="intereses_ayuda_solicita_idi_isba" (blur)="checkTotalAmount()">
                        <mat-error *ngIf="isbaForm.get('intereses_ayuda_solicita_idi_isba')?.errors as errores">
                            <ng-container *ngIf="errores['invalidDecimal']">{{'FORMERRORS.COMMON.DECIMAL' | translate}}</ng-container>
                            <ng-container *ngIf="errores['notEqualError']">{{'FORMERRORS.ISBA.SUMASUBSNOIGUAL' | translate}}</ng-container>
                            <ng-container *ngIf="!errores['invalidDecimal'] && !errores['notEqualError']">{{'FORMERRORS.ISBA.SUBVENCIONES' | translate}}</ng-container>
                        </mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'ISBA.COSTSUBSIDY' | translate}}</mat-label>
                        <input matInput type="decimal" (blur)="cleanBlank($event)" min="0" formControlName="coste_aval_solicita_idi_isba" (blur)="checkTotalAmount()">
                        <mat-error *ngIf="isbaForm.get('coste_aval_solicita_idi_isba')?.errors as errores">
                            <ng-container *ngIf="errores['invalidDecimal']">{{'FORMERRORS.COMMON.DECIMAL' | translate}}</ng-container>
                            <ng-container *ngIf="errores['notEqualError']">{{'FORMERRORS.ISBA.SUMASUBSNOIGUAL' | translate}}</ng-container>
                            <ng-container *ngIf="!errores['invalidDecimal'] && !errores['notEqualError']">{{'FORMERRORS.ISBA.SUBVENCIONES' | translate}}</ng-container>
                        </mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'ISBA.STARTSTUDYSUBSIDY' | translate}}</mat-label>
                        <input matInput type="decimal" (blur)="cleanBlank($event)" min="0" formControlName="gastos_aval_solicita_idi_isba" (blur)="checkTotalAmount()">
                        <mat-error *ngIf="isbaForm.get('gastos_aval_solicita_idi_isba')?.errors as errores">
                            <ng-container *ngIf="errores['invalidDecimal']">{{'FORMERRORS.COMMON.DECIMAL' | translate}}</ng-container>
                            <ng-container *ngIf="errores['notEqualError']">{{'FORMERRORS.ISBA.SUMASUBSNOIGUAL' | translate}}</ng-container>
                            <ng-container *ngIf="!errores['invalidDecimal'] && !errores['notEqualError']">{{'FORMERRORS.ISBA.SUBVENCIONES' | translate}}</ng-container>
                        </mat-error>
                    </mat-form-field>
                </section>
                <section style="padding-bottom: 1.1rem;">
                    <dl><h4>{{'ISBA.REQUESTTITLE' | translate}}</h4></dl>
                    <dt>{{'ISBA.REQUESTINFO' | translate}}</dt>
                </section>
                <section ngClass="form project-budget">
                    <mat-form-field>
                        <mat-label>{{'ISBA.REQUEST' | translate}}</mat-label>
                        <input matInput type="decimal" (blur)="cleanBlank($event); checkAmount()" min="0" formControlName="importe_ayuda_solicita_idi_isba">
                        <mat-error *ngIf="isbaForm.get('importe_ayuda_solicita_idi_isba')?.errors">{{((isbaForm.get('importe_ayuda_solicita_idi_isba')?.hasError('invalidDecimal') ? 'FORMERRORS.COMMON.DECIMAL' : 'FORMERRORS.ISBA.SOLICITUDAYUDA') | translate)}}</mat-error>
                    </mat-form-field>
                </section>
            </mat-expansion-panel>

            <!-- Declaracion responsable -->
            <mat-expansion-panel [disabled]="!rgpdAccepted" [expanded]="rgpdAccepted">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'FORM.RESPONSIBLEDECLARATION' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'FORM.RESPONSIBLEDECLARATIONDESCRIPTION' | translate}} <mat-icon>menu_book</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <h4>{{'ISBA.DECLARATIONINFO' | translate}}</h4>
                <section ngClass="form declaration-checkboxes">
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_0"><label>1. {{'ISBA.DECLARATION1' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_1"><label>2. {{'ISBA.DECLARATION2' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_2"><label>3. {{'ISBA.DECLARATION3' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_3"><label>4. {{'ISBA.DECLARATION4' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_4"><label>5. {{'ISBA.DECLARATION5' | translate}}</label></mat-checkbox>
                    <section ngClass="afterFormChange" *ngIf="!ayudasSubvenciones">
                        <mat-form-field>
                            <mat-label>{{'ISBA.DECLARATION5NO' | translate}}</mat-label>
                            <input matInput type="text" formControlName="ayudasSubvenSICuales_dec_resp">
                            <mat-error *ngIf="isbaForm.get('ayudasSubvenSICuales_dec_resp')?.errors">{{'FORMERRORS.ISBA.DECLARACION5' | translate}}</mat-error>
                        </mat-form-field>
                    </section>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_5"><label>6. {{'ISBA.DECLARATION6' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_7"><label>7. {{'ISBA.DECLARATION7' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_8"><label>8. {{'ISBA.DECLARATION8' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_10"><label>9. {{'ISBA.DECLARATION9' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_12"><label>10. {{'ISBA.DECLARATION10' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_13"><label>11. {{'ISBA.DECLARATION11' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_14"><label>12. {{'ISBA.DECLARATION12' | translate}}</label></mat-checkbox>
                    <mat-checkbox formControlName="declaro_idi_isba_que_cumple_15"><label>13. {{'ISBA.DECLARATION13' | translate}}</label></mat-checkbox>
                </section>
            </mat-expansion-panel>

             <!-- Documentación -->
            <mat-expansion-panel [disabled]="!rgpdAccepted" [expanded]="rgpdAccepted">
                <mat-expansion-panel-header>
                    <mat-panel-title><h3>{{'FORM.DOCUMENTATIONTITLE' | translate}}</h3></mat-panel-title>
                    <mat-panel-description>{{'FORM.DOCUMENTATIONDESCRIPTION' | translate}} <mat-icon>attachment</mat-icon></mat-panel-description>
                </mat-expansion-panel-header>
                <section>
                    <p [innerHTML]="'FORM.DOCUMENTATIONINFOFORMAT' | translate"></p>
                    <ol>
                        <li [innerHTML]="'FORM.DOCUMENTATIONINFOCTRL' | translate"></li>
                        <li [innerHTML]="'FORM.DOCUMENTATIONINFOSHIFT' | translate"></li>
                    </ol>
                </section>
                <section ngClass="file-input">
                    <p>{{'ISBA.DOC1' | translate}}</p>
                </section>
                
                <section ngClass="file-upload">
                    <label for="file_memoriaTecnica">{{'ISBA.DOC2' | translate}}</label>
                    <input #file_memoriaTecnica formControlName="file_memoriaTecnica" type="file" (change)="onFileMemoriaTecnicaChange($event)" multiple accept=".pdf">
                    <mat-error *ngIf="isbaForm.get('file_memoriaTecnica')?.errors && isbaForm.get('file_memoriaTecnica')?.dirty">{{'FORMERRORS.COMMON.FILE' | translate}}</mat-error>
                    <ul *ngIf="file_memoriaTecnicaToUpload.length > 0">
                        <li *ngFor="let file of file_memoriaTecnicaToUpload">{{ file.name }} ({{file.size/1024 | number:'1.2-2':'es-ES'}} KB)</li>
                    </ul>
                </section>

                <section ngClass="file-upload">
                    <label for="file_document_veracidad_datos_bancarios">{{'ISBA.DOC3' | translate}}</label>
                    <input #file_document_veracidad_datos_bancarios formControlName="file_document_veracidad_datos_bancarios" type="file" (change)="onfile_document_veracidad_datos_bancariosChange($event)" multiple accept=".pdf">
                    <mat-error *ngIf="isbaForm.get('file_document_veracidad_datos_bancarios')?.errors && isbaForm.get('file_document_veracidad_datos_bancarios')?.dirty">{{'FORMERRORS.COMMON.FILE' | translate}}</mat-error>
                    <ul *ngIf="file_document_veracidad_datos_bancariosToUpload.length > 0">
                        <li *ngFor="let file of file_document_veracidad_datos_bancariosToUpload">{{ file.name }} ({{file.size/1024 | number:'1.2-2':'es-ES'}} KB)</li>
                    </ul>
                </section>

                <section ngClass="file-upload">
                    <label for="file_certificadoIAE">{{'ISBA.DOC4' | translate}}</label>
                    <input #file_certificadoIAE formControlName="file_certificadoIAE" type="file" (change)="onfile_certificadoIAEChange($event)" multiple accept=".pdf">
                    <mat-error *ngIf="isbaForm.get('file_certificadoIAE')?.errors && isbaForm.get('file_certificadoIAE')?.dirty">{{'FORMERRORS.COMMON.FILE' | translate}}</mat-error>
                    <ul *ngIf="file_certificadoIAEToUpload.length > 0">
                        <li *ngFor="let file of file_certificadoIAEToUpload">{{ file.name }} ({{file.size/1024 | number:'1.2-2':'es-ES'}} KB)</li>
                    </ul>
                </section>

                <!-- Persona física-->
                <section ngClass="file-upload" *ngIf="businessType === 'autonomo'">
                    <p [innerHTML]="'ISBA.DOC5TITLE' | translate"></p>
                    <label for="file_altaAutonomos">{{'ISBA.DOC5DOC' | translate}}</label>
                    <input #file_altaAutonomos formControlName="file_altaAutonomos" type="file" (change)="onfile_altaAutonomosChange($event)" multiple accept=".pdf">
                    <mat-error *ngIf="isbaForm.get('file_altaAutonomos')?.errors && isbaForm.get('file_altaAutonomos')?.dirty">{{'FORMERRORS.COMMON.FILE' | translate}}</mat-error>
                    <ul *ngIf="file_altaAutonomosToUpload.length > 0">
                        <li *ngFor="let file of file_altaAutonomosToUpload">{{ file.name }} ({{file.size/1024 | number:'1.2-2':'es-ES'}} KB)</li>
                    </ul>
                </section>

                <!-- Persona Jurídica -->
                <section ngClass="file-upload" *ngIf="businessType !== 'autonomo'">
                    <dl>
                        <dt [innerHTML]="'ISBA.DOC6TITLE' | translate"></dt>
                        <dd>{{'ISBA.DOC6DOC1' | translate}}</dd>
                        <dd>{{'ISBA.DOC6DOC2' | translate}}</dd>
                    </dl>
                    <label for="file_escrituraConstitucion">{{'ISBA.DOC6LABEL' | translate}}</label>
                    <input #file_escrituraConstitucion formControlName="file_escrituraConstitucion" type="file" (change)="onfile_escrituraConstitucionChange($event)" multiple accept=".pdf">
                    <mat-error *ngIf="isbaForm.get('file_escrituraConstitucion')?.errors && isbaForm.get('file_escrituraConstitucion')?.dirty">{{'FORMERRORS.COMMON.FILE' | translate}}</mat-error>
                    <ul *ngIf="file_escrituraConstitucionToUpload.length > 0">
                        <li *ngFor="let file of file_escrituraConstitucionToUpload">{{ file.name }} ({{file.size/1024 | number:'1.2-2':'es-ES'}} KB)</li>
                    </ul>
                </section>

                <section ngClass="file-upload">
                    <p>{{'ISBA.DOC7INFO' | translate}}</p>
                    <mat-checkbox ngClass="documento-en-adr" formControlName="dni_no_consent" (change)="onCheckboxFileChange($event, 'file_nifRepresentante')">{{'FILES.NOTAUTHORIZED' | translate}}</mat-checkbox>
                    <label for="file_nifRepresentante">{{'ISBA.DOC7LABEL' | translate}}</label>
                    <input #file_nifRepresentante formControlName="file_nifRepresentante" type="file" (change)="onfile_nifRepresentanteChange($event)" multiple accept=".pdf">
                    <mat-error *ngIf="isbaForm.get('file_nifRepresentante')?.errors && isbaForm.get('file_nifRepresentante')?.dirty">{{'FORMERRORS.COMMON.FILE' | translate}}</mat-error>
                    <ul *ngIf="file_nifRepresentanteToUpload.length > 0">
                        <li *ngFor="let file of file_nifRepresentanteToUpload">{{ file.name }} ({{file.size/1024 | number:'1.2-2':'es-ES'}} KB)</li>
                    </ul>
                </section>

                <section ngClass="file-upload">
                    <p>{{'ISBA.DOC8INFO' | translate}}</p>
                    <mat-checkbox ngClass="documento-en-adr" formControlName="atib_no_consent" (change)="onCheckboxFileChange($event, 'file_certificadoATIB')">{{'FILES.NOTAUTHORIZED' | translate}}</mat-checkbox>
                    <label for="file_certificadoATIB">{{'ISBA.DOC8LABEL' | translate}}</label>
                    <input #file_certificadoATIB formControlName="file_certificadoATIB" type="file" (change)="onfile_certificadoATIBChange($event)" multiple accept=".pdf">
                    <mat-error *ngIf="isbaForm.get('file_certificadoATIB')?.errors && isbaForm.get('file_certificadoATIB')?.dirty">{{'FORMERRORS.COMMON.FILE' | translate}}</mat-error>
                    <ul *ngIf="file_certificadoATIBToUpload.length > 0">
                        <li *ngFor="let file of file_certificadoATIBToUpload">{{ file.name }} ({{file.size/1024 | number:'1.2-2':'es-ES'}} KB)</li>
                    </ul>
                </section>

                <section ngClass="file-upload">
                    <label for="file_certificadoAEAT">{{'ISBA.DOC9' | translate}}</label>
                    <input #file_certificadoAEAT formControlName="file_certificadoAEAT" type="file" (change)="onfile_certificadoAEATChange($event)" multiple accept=".pdf">
                    <mat-error *ngIf="isbaForm.get('file_certificadoAEAT')?.errors && isbaForm.get('file_certificadoAEAT')?.dirty">{{'FORMERRORS.COMMON.FILE' | translate}}</mat-error>
                    <ul *ngIf="file_certificadoAEATToUpload.length > 0">
                        <li *ngFor="let file of file_certificadoAEATToUpload">{{ file.name }} ({{file.size/1024 | number:'1.2-2':'es-ES'}} KB)</li>
                    </ul>
                </section>

                <section ngClass="file-upload" *ngIf="isSubsidyGreater">
                    <label for="file_certificadoLey382003">{{'ISBA.DOC10' | translate}}</label>
                    <input #file_certificadoLey382003 formControlName="file_certificadoLey382003" type="file" (change)="onfile_certificadoLey382003Change($event)" multiple accept=".pdf">
                    <mat-error *ngIf="isbaForm.get('file_certificadoLey382003')?.errors && isbaForm.get('file_certificadoLey382003')?.dirty">{{'FORMERRORS.COMMON.FILE' | translate}}</mat-error>
                    <ul *ngIf="file_certificadoLey382003ToUpload.length > 0">
                        <li *ngFor="let file of file_certificadoLey382003ToUpload">{{ file.name }} ({{file.size/1024 | number:'1.2-2':'es-ES'}} KB)</li>
                    </ul>
                </section>

                <section ngClass="file-upload">
                    <label for="file_certificadoSGR">{{'ISBA.DOC11' | translate}}</label>
                    <input #file_certificadoSGR formControlName="file_certificadoSGR" type="file" (change)="onfile_certificadoSGRChange($event)" multiple accept=".pdf">
                    <mat-error *ngIf="isbaForm.get('file_certificadoSGR')?.errors && isbaForm.get('file_certificadoSGR')?.dirty">{{'FORMERRORS.COMMON.FILE' | translate}}</mat-error>
                    <ul *ngIf="file_certificadoSGRToUpload.length > 0">
                        <li *ngFor="let file of file_certificadoSGRToUpload">{{ file.name }} ({{file.size/1024 | number:'1.2-2':'es-ES'}} KB)</li>
                    </ul>
                </section>

                <section ngClass="file-upload">
                    <label for="file_contratoOperFinanc">{{'ISBA.DOC12' | translate}}</label>
                    <input #file_contratoOperFinanc formControlName="file_contratoOperFinanc" type="file" (change)="onfile_contratoOperFinancChange($event)" multiple accept=".pdf">
                    <mat-error *ngIf="isbaForm.get('file_contratoOperFinanc')?.errors && isbaForm.get('file_contratoOperFinanc')?.dirty">{{'FORMERRORS.COMMON.FILE' | translate}}</mat-error>
                    <ul *ngIf="file_contratoOperFinancToUpload.length > 0">
                        <li *ngFor="let file of file_contratoOperFinancToUpload">{{ file.name }} ({{file.size/1024 | number:'1.2-2':'es-ES'}} KB)</li>
                    </ul>
                </section>

                <section ngClass="file-upload">
                    <label for="file_avalOperFinanc">{{'ISBA.DOC13' | translate}}</label>
                    <input #file_avalOperFinanc formControlName="file_avalOperFinanc" type="file" (change)="onfile_avalOperFinancChange($event)" multiple accept=".pdf">
                    <mat-error *ngIf="isbaForm.get('file_avalOperFinanc')?.errors && isbaForm.get('file_avalOperFinanc')?.dirty">{{'FORMERRORS.COMMON.FILE' | translate}}</mat-error>
                    <ul *ngIf="file_avalOperFinancToUpload.length > 0">
                        <li *ngFor="let file of file_avalOperFinancToUpload">{{ file.name }} ({{file.size/1024 | number:'1.2-2':'es-ES'}} KB)</li>
                    </ul>
                </section>
                <section ngClass="file-input">
                    <p>{{'ISBA.DOC14' | translate}}</p>
                </section>
            </mat-expansion-panel>
        </mat-accordion>
        <mat-form-field style="display: none">
            <input matInput type="text" formControlName="tipo_tramite">
        </mat-form-field>
        <button mat-raised-button color="primary" type="submit" [disabled]="isbaForm.invalid || submitting">{{'APP.SEND' | translate}}</button>
    </form>
</section>