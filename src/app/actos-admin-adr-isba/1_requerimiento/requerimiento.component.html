<form [formGroup]="formRequerimiento">
    <mat-accordion [ngClass]="['detalle-formulario', 'req-state', stateClass]">
        <mat-expansion-panel>
            <mat-expansion-panel-header>
                <mat-panel-title>1. {{'ACTOSADMINISTRATIVOS.REQUERIMIENTO' | translate}}</mat-panel-title>
            </mat-expansion-panel-header>
            <mat-form-field appearance="outline">
                <mat-label>{{'ACTOSADMINISTRATIVOS.REASONS.REQUERIMENT' | translate}}</mat-label>
                <textarea matInput formControlName="motivoRequerimiento" required rows="5"></textarea>
            </mat-form-field>
            <button mat-raised-button color="primary" type="submit" (click)="saveReasonRequest()" [disabled]="!formRequerimiento.valid">{{'ACTOSADMINISTRATIVOS.GENERAL.SAVEREASON' | translate}}</button>
            <button mat-raised-button color="accent" (click)="reqGenerado ? viewActoAdmin(actualNif, 'informes', nameDocgenerado, 'pdf') : generateActoAdmin('isba_1_requerimiento', 'ADR-ISBA', 'requeriment_adr_isba')" [disabled]="!reqGenerado && noRequestReasonText">
                {{reqGenerado ? ('ACTOSADMINISTRATIVOS.GENERAL.VIEWACTO' | translate) : ('ACTOSADMINISTRATIVOS.GENERAL.GENERATEACTO' | translate)}}
            </button>
            <button *ngIf="!publicAccessId" mat-raised-button color="warn" (click)="sendActoAdminToSign(actualNif, 'informes', nameDocgenerado, 'pdf')" [disabled]="!reqGenerado">{{'ACTOSADMINISTRATIVOS.GENERAL.SENDTOTECHNICIAN' | translate}}</button>
            <section *ngIf="publicAccessId" [ngClass]="['detalle-formulario', 'req-state', stateClass]">
                <section *ngIf="signatureDocState === 'COMPLETED'">
                  <a  href='{{externalSignUrl}}' target="_blank">{{'ACTOSADMINISTRATIVOS.SIGNATURESTATUS.VIEWSIGNEDDOC' | translate}}</a>
                </section>
                <section *ngIf="signatureDocState === 'REJECTED'">{{'ACTOSADMINISTRATIVOS.SIGNATURESTATUS.REJECTED' | translate}}</section>
                <section *ngIf="signatureDocState === 'NOT_STARTED'">
                  <span>{{'ACTOSADMINISTRATIVOS.SIGNATURESTATUS.PENDING' | translate}}</span><br>
                  <span>{{'ACTOSADMINISTRATIVOS.SIGNATURESTATUS.PENDINGEMAIL' | translate}} <strong>{{sendedUserToSign | lowercase}}</strong></span><br>
                  <span>{{'ACTOSADMINISTRATIVOS.SIGNATURESTATUS.PENDINGDATE' | translate}} <strong>{{sendedDateToSign | date:'dd/MM/yyyy HH:mm:ss'}}</strong></span>
                  <button mat-raised-button color="warn" (click)="sendActoAdminToSign(actualNif, 'informes', nameDocgenerado, 'pdf')" [disabled]="!reqGenerado">{{'ACTOSADMINISTRATIVOS.GENERAL.SENDTOSIGNAGAIN' | translate}}</button>
                </section>
                <section *ngIf="signatureDocState === 'IN_PROCESS'">
                  <span>{{'ACTOSADMINISTRATIVOS.SIGNATURESTATUS.PROGRESS' | translate}}</span>
                </section>
              </section>
            <iframe *ngIf="pdfUrl" [src]="pdfUrl" width="100%" height="600px" ngClass="pdf-container"></iframe>
            <button mat-button color="warn" ngClass="close-button" *ngIf="showPdfViewer" (click)="closeViewActoAdmin()">{{'ACTOSADMINISTRATIVOS.GENERAL.CLOSE' | translate}} âœ–</button> 
        </mat-expansion-panel>
    </mat-accordion>
</form>
