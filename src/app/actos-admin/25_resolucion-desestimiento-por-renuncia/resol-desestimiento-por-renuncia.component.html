<form [formGroup]="formDesestimiento">
    <mat-accordion [ngClass]="['detalle-formulario', 'req-state', stateClass]">
        <mat-expansion-panel>
            <mat-expansion-panel-header>
                <mat-panel-title>25. {{'ACTOSADMINISTRATIVOS.RESOLUCIONDESESTIMIENTORENUNCIA' | translate}}</mat-panel-title>
            </mat-expansion-panel-header>
            <mat-form-field appearance="outline">
                <mat-label>Motivo de la dejación</mat-label>
                <textarea matInput formControlName="motivoDesestimientoRenuncia" required rows="5"></textarea>
            </mat-form-field>
            <button mat-raised-button color="primary" type="submit" (click)="saveDesestimientoReason()" [disabled]="!formDesestimiento.valid">Guardar</button>
            <button mat-raised-button color="accent" (click)="actoAdmin25 ? viewActoAdmin(actualNif, 'informes', nameDocGenerado, 'pdf') : generateActoAdmin('25_resolucion_desistimiento', 'XECS', 'resolucion_desestimiento_renuncia')" [disabled]="!actoAdmin25 && noDesestimientoReasonText">
                {{actoAdmin25 ? 'Ver documento' : 'Generar'}}
            </button>
            <button *ngIf="!publicAccessId" mat-raised-button color="warn" (click)="sendActoAdminToSign(actualNif,'informes', nameDocGenerado, 'pdf')" [disabled]="!actoAdmin25">Send to sign</button>
            <section *ngIf="publicAccessId" [ngClass]="['detalle-formulario', 'req-state', stateClass]">
                <section *ngIf="signatureDocState === 'COMPLETED'">
                  <a  href='{{externalSignUrl}}' target="_blank">Ver el documento firmado</a>
                </section>
                <section *ngIf="signatureDocState === 'REJECTED'">Firma rechazada</section>
                <section *ngIf="signatureDocState === 'NOT_STARTED'">
                  <span>Pendiente de firma.</span><br>
                  <span>Este documento se envió a firmar a la dirección: <strong>{{sendedUserToSign | lowercase}}</strong></span><br>
                  <span>en la fecha: <strong>{{sendedDateToSign | date:'dd/MM/yyyy HH:mm:ss'}}</strong></span>
                  <button mat-raised-button color="warn" (click)="sendActoAdminToSign(actualNif, 'informes', nameDocGenerado, 'pdf')" [disabled]="!actoAdmin25">Send to sign again</button>
                </section>
                <section *ngIf="signatureDocState === 'IN_PROCESS'">
                  <span>Firma en curso</span>
                </section>
            </section>
            <section *ngIf="faltanCampos" style="margin-top: 10px;">
                <span>Faltan los campos:</span>
                <ol>
                    <li *ngFor="let campo of camposVacios;">{{campo | translate}}</li>
                </ol>
            </section>
            <iframe *ngIf="pdfUrl" [src]="pdfUrl" width="100%" height="600px" ngClass="pdf-container"></iframe>
            <button mat-button color="warn" ngClass="close-button" *ngIf="showPdfViewer" (click)="closeViewActoAdmin()">Cerrar ✖</button> 
        </mat-expansion-panel>
    </mat-accordion>
</form>