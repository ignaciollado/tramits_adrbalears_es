<form [formGroup]="formPRProvDesf">
  <mat-accordion [ngClass]="['detalle-formulario', 'req-state', stateClass]">
   <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title> {{'ACTOSADMINISTRATIVOS.PROPUESTARESOLUCIONPROVISIONALDESFAVORABLE' | translate}} </mat-panel-title>
    </mat-expansion-panel-header>
    <mat-form-field appearance="outline">
        <mat-label>Motivo de la denegación</mat-label>
        <textarea matInput formControlName="motivoDenegacion" required rows="5"></textarea>
    </mat-form-field>
    <button mat-raised-button color="primary" type="submit" (click)="saveReasonRequest()" [disabled]="!formPRProvDesf.valid">Guardar</button>
    <button mat-raised-button color="accent" (click)="actoAdmin9 ? viewActoAdmin(actualNif, 'informes', nameDocgenerado, 'pdf') : generateActoAdmin('9_propuesta_resolucion_provisional_desfavorable_sin_requerimiento', 'XECS', 'propuesta_resolucion_provisional_desfavorable_sin_requerimiento')" [disabled]="!actoAdmin9 && noDenegationReasonText">
      {{ actoAdmin9 ? 'Ver documento' : 'Generar' }}
    </button>
    <button *ngIf="!publicAccessId" mat-raised-button color="warn" (click)="sendActoAdminToSign(actualNif, 'informes', nameDocgenerado, 'pdf')" [disabled]="!actoAdmin9">Send to sign</button>
    -{{signedBy}}-<section *ngIf="publicAccessId" [ngClass]="['detalle-formulario', 'req-state', stateClass]">
      <section *ngIf="signatureDocState === 'COMPLETED'">
        <a  href='{{externalSignUrl}}' target="_blank">Ver el documento firmado</a>
      </section>
      <section *ngIf="signatureDocState === 'REJECTED'">Firma rechazada</section>
      <section *ngIf="signatureDocState === 'NOT_STARTED'">
        <span>Pendiente de firma.</span><br>
        <span>Este documento se envió a firmar a la dirección: <strong>{{sendedUserToSign}}</strong></span><br>
        <span>en la fecha: <strong>{{sendedDateToSign | date:'dd/MM/yyyy HH:mm:ss'}}</strong></span>
        <button mat-raised-button color="warn" (click)="sendActoAdminToSign(actualNif, 'informes', nameDocgenerado, 'pdf')" [disabled]="!actoAdmin9">Send to sign again</button>
      </section>
      <section *ngIf="signatureDocState === 'IN_PROCESS'">
        <span>Firma en curso</span>
      </section>
    </section>     
    <iframe *ngIf="pdfUrl" [src]="pdfUrl" width="100%" height="600px" ngClass="pdf-container"></iframe>
    <button mat-button color="warn" ngClass="close-button"  *ngIf="showPdfViewer" (click)="closeViewActoAdmin()">Cerrar ✖</button>        
  </mat-expansion-panel>
</mat-accordion>
</form>
